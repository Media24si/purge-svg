"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var path=_interopDefault(require("path")),fs=_interopDefault(require("fs")),glob=_interopDefault(require("glob")),CONFIG_FILENAME="purgesvg.config.js",ERROR_CONFIG_FILE_LOADING="Error loading the config file",ERROR_OPTIONS_TYPE="Error Type Options: expected an object",ERROR_WHITELIST_TYPE="Error Type option whitelist: expected an array",ERROR_OUTPUT_TYPE="Error Type option output: expected a string",ERROR_MISSING_CONTENT="No content provided.",ERROR_MISSING_SVGS="No svgs provided.",_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},defaultOptions={content:[],svgs:[],whitelist:[],output:void 0},removeDuplicates=function(e,t,r){return r.indexOf(e)===t},flatten=function(e,t){return[].concat(toConsumableArray(e),toConsumableArray(t))},PurgeSvg=function(){function e(t){classCallCheck(this,e),"string"!=typeof t&&void 0!==t||(t=e.loadConfigFile(t)),e.validateOptions(t),this.options=Object.assign(defaultOptions,t)}return createClass(e,null,[{key:"loadConfigFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CONFIG_FILENAME;try{return require(path.resolve(process.cwd(),e))}catch(e){throw new Error(ERROR_CONFIG_FILE_LOADING)}}},{key:"validateOptions",value:function(e){if("object"!==(void 0===e?"undefined":_typeof(e)))throw new TypeError(ERROR_OPTIONS_TYPE);if(!e.content||!e.content.length)throw new TypeError(ERROR_MISSING_CONTENT);if(!e.svgs||!e.svgs.length)throw new TypeError(ERROR_MISSING_SVGS);if(!e.output||"string"!=typeof e.output)throw new TypeError(ERROR_OUTPUT_TYPE);if(e.whitelist&&!Array.isArray(e.whitelist))throw new TypeError(ERROR_WHITELIST_TYPE)}},{key:"globPaths",value:function(e){return"string"==typeof e&&(e=[e]),e.map(function(e){return fs.existsSync(e)?[e]:[].concat(toConsumableArray(glob.sync(e,{nodir:!0})))}).reduce(flatten,[]).filter(removeDuplicates).map(function(e){return path.resolve(process.cwd(),e)})}},{key:"extractContentIds",value:function(t){return e.globPaths(t).map(function(e){return fs.readFileSync(e,"utf-8").match(/\.svg#([A-Za-z0-9_-]+)"/g).map(function(e){return e.slice(5,-1)})}).reduce(flatten,[]).filter(removeDuplicates)}}]),e}();module.exports=PurgeSvg;
